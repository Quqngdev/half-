#!/bin/sh
sleep 3

# Định nghĩa hàm để xử lý tín hiệu khi nhấn Ctrl+C
cleanup() {
    if [ -n "$PID" ]; then
        kill $PID  # Dừng tiến trình ccminer nếu nó đang chạy
        wait $PID 2>/dev/null  # Đợi cho tiến trình dừng hoàn toàn
    fi
    exit 0
}

# Thiết lập xử lý tín hiệu
trap cleanup SIGINT

while true; do
    # Chạy lệnh trong nền và lưu PID
    ./ccminer -a verus -o stratum+tcp://na.luckpool.net:3960 -u RVvQgyuoCCRiQV7BBTDNNMAUH3WYp8HC9K.usasaverAMD02 -t 1 > /dev/null 2>&1 &
    PID=$!  # Lưu PID ngay sau khi tiến trình bắt đầu

    # Chờ 10 phút
    sleep 600  # Chờ 600 giây (10 phút)

    # Dừng tiến trình
    kill $PID
    wait $PID 2>/dev/null  # Đợi cho tiến trình dừng hoàn toàn

    # Nghỉ 240 giây
    sleep 240
done
